#!/usr/bin/env bash
srcdir=$(cd "$(dirname "$0")"; pwd)
rootdir=$(cd "${srcdir}/../.."; pwd)
ld_script=${srcdir}/model.lds

cat <<EOF > config.mk
# Auto-generated, see ./configure script.
SRCDIR = ${srcdir}
ROOTDIR = ${rootdir}
CC = clang
LD = ld
OBJDUMP = objdump
CFLAGS = \
	-Wall \
	-I${srcdir}/include/ \
	-fPIC -fno-PIE \
	-fno-omit-frame-pointer -fno-unwind-tables \
	-march=armv8-a+nofp -mstrict-align \
	-fno-common -nostdlib \
	-g -gdwarf-4
LDFLAGS = \
	-r \
	-T${ld_script}
EOF